<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering Pseudotime Inference on Skin Cell scRNA-seq • RSoptSC</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Clustering Pseudotime Inference on Skin Cell scRNA-seq">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RSoptSC</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RSoptSC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Joost_et_al.html">Clustering Pseudotime Inference on Skin Cell scRNA-seq</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/mkarikom/RSoptSC">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="RSoptSC_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Clustering Pseudotime Inference on Skin Cell scRNA-seq</h1>
                        <h4 class="author">Matt Karikomi</h4>
            
            <h4 class="date">2019-04-06</h4>
      
      
      <div class="hidden name"><code>RSoptSC.Rmd</code></div>

    </div>

    
    
<p>This is an example of clustering, marker identification and pseudotime inference on a set of skin cells.</p>
<div id="load-and-preprocess-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-and-preprocess-data" class="anchor"></a>Load and Preprocess Data</h2>
<p>A matrix of counts with rows as genes and columns as cells must be provided. Gene and cell ids, and [optionally] a vector of labels e.g. cell types are provided in separate text files. Here we load example data from NCBI GEO (GSE67602) originally published in Joost et al 2016.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(RSoptSC)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostData.csv.bz2"</span>, <span class="dt">package =</span> <span class="st">"RSoptSC"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">gf &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostGenes.csv.bz2"</span>, <span class="dt">package =</span> <span class="st">"RSoptSC"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">cf &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostCells.csv.bz2"</span>, <span class="dt">package =</span> <span class="st">"RSoptSC"</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">af &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostAnnotation.csv.bz2"</span>, <span class="dt">package =</span> <span class="st">"RSoptSC"</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">GSE67602_Joost &lt;-<span class="st"> </span><span class="kw"><a href="../reference/LoadData.html">LoadData</a></span>(df, gf, cf, af)</a></code></pre></div>
<div id="remove-spike-in-rna" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-spike-in-rna" class="anchor"></a>Remove Spike-in RNA</h3>
<p>Apply number of features and exclusion threshold</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">logdata &lt;-<span class="st"> </span><span class="kw">log10</span>(data <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">gene_expression_threshold &lt;-<span class="st"> </span><span class="fl">0.03</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">n_features &lt;-<span class="st"> </span><span class="dv">3000</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">filtered_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/SelectData.html">SelectData</a></span>(logdata, gene_expression_threshold, n_features)</a></code></pre></div>
</div>
</div>
<div id="compute-the-similarity-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-the-similarity-matrix" class="anchor"></a>Compute the Similarity Matrix</h2>
<p>Run L2R2 on the processed data, outputting the number of iterations and value of the objective.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">S &lt;-<span class="st"> </span><span class="kw"><a href="../reference/SimilarityM.html">SimilarityM</a></span>(<span class="dt">lambda =</span> <span class="fl">0.05</span>, </a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                 <span class="dt">data =</span> filtered_data<span class="op">$</span>M_variable,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                 <span class="dt">dims =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                 <span class="dt">pre_embed_method =</span> <span class="st">'tsne'</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                 <span class="dt">perplexity =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                 <span class="dt">pca_center =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                 <span class="dt">pca_scale =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Compute distances on the similarity matrix. If the truncated graph has multiple components, join them to improve inter-cluster distance estimation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">low_dim_mapping &lt;-<span class="st"> </span><span class="kw"><a href="../reference/RepresentationMap.html">RepresentationMap</a></span>(<span class="dt">similarity_matrix =</span> S<span class="op">$</span>W,</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">                            <span class="dt">flat_embedding_method =</span> <span class="st">'tsne'</span>,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                            <span class="dt">join_components =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                            <span class="dt">perplexity =</span> <span class="dv">35</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                            <span class="dt">theta =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                            <span class="dt">normalize =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">                            <span class="dt">pca =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">                            <span class="dt">pca_center =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">                            <span class="dt">pca_scale =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">                            <span class="dt">dims =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">                            <span class="dt">initial_dims =</span> <span class="dv">2</span>)</a></code></pre></div>
</div>
<div id="cluster-the-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#cluster-the-cells" class="anchor"></a>Cluster the Cells</h2>
<p>Infer cluster number using spectra of the ensemble Laplacian.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">clusters &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CountClusters.html">CountClusters</a></span>(<span class="dt">data =</span> S<span class="op">$</span>W, <span class="dt">n_comp =</span> <span class="dv">15</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">n_clusters &lt;-<span class="st"> </span>clusters<span class="op">$</span>upper_bound</a></code></pre></div>
<p>In this analysis, we obtain bounds on the number of clusters, where the lower bound is equal to the number of zero eigenvalues and the upper bound is the index of the eigenvalue preceding the largest eigengap. We take this value as the cluster number here.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>), </a>
<a class="sourceLine" id="cb6-2" data-line-number="2">     clusters<span class="op">$</span>eigs<span class="op">$</span>val[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">     <span class="dt">xlab =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">     <span class="dt">ylab =</span> <span class="st">'eigenvalues'</span>,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">     <span class="dt">main =</span> <span class="st">'Eigenvalues of the Graph Laplacian'</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Factor the similarity matrix such that W = HxH’, using the computed cluster number for the rank of H.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">output_NMF &lt;-<span class="st"> </span>NMF<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/NMF/topics/nmf">nmf</a></span>(<span class="dt">x =</span> Matrix<span class="op">::</span><span class="kw">as.matrix</span>(S<span class="op">$</span>W),</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">              <span class="dt">rank =</span> n_clusters,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">              <span class="dt">method =</span> <span class="st">'lee'</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">              <span class="dt">seed =</span> <span class="st">'nndsvd'</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">              <span class="dt">.options =</span> <span class="st">'nP'</span>);</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">H &lt;-<span class="st"> </span>NMF<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/NMF/topics/basis-coef-methods">basis</a></span>(output_NMF)</a></code></pre></div>
<p>Assign cluster labels to the cells.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">labels &lt;-<span class="st"> </span><span class="kw">apply</span>(H, <span class="dv">1</span>, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="kw">which</span>(x <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(x))})</a></code></pre></div>
<div id="visualize-the-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-clusters" class="anchor"></a>Visualize the Clusters</h3>
<p>Cells are labeled by cluster membership and plotted on low-dimensional embedding (t-SNE) of the similarity matrix.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># define a scheme for the coloring.  This is a required parameter for plotting discrete (factor) data</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">colorscale &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ColorHue.html">ColorHue</a></span>(<span class="dt">n =</span> <span class="kw">length</span>(<span class="kw">unique</span>(labels)))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">colorscale &lt;-<span class="st"> </span>colorscale<span class="op">$</span>hex.<span class="fl">1.</span>n.</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co"># plot clusters</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span>(<span class="dt">flat_embedding =</span> low_dim_mapping<span class="op">$</span>flat_embedding,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                         <span class="dt">feature =</span> <span class="kw">as.factor</span>(labels),</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">                         <span class="dt">title =</span> <span class="st">"NMF Cluster Labeling"</span>,</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">                         <span class="dt">subtitle =</span> <span class="st">"t-SNE Embedding"</span>,</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">                         <span class="dt">featurename =</span> <span class="st">"Cluster ID"</span>,</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">                         <span class="dt">colorscale =</span> colorscale)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-10-1.png" width="100%" height="100%"></p>
<p>As described in Joost et al (2016), Subpopulations including Basal, IFE-DI, IFE-DII, IFE-KI, IFE-KII were identified by standard techniques.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">true_labels &lt;-<span class="st"> </span>GSE67602_Joost<span class="op">$</span>annotation</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># plot clusters</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span>(<span class="dt">flat_embedding =</span> low_dim_mapping<span class="op">$</span>flat_embedding,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                         <span class="dt">feature =</span> <span class="kw">as.factor</span>(true_labels),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                         <span class="dt">title =</span> <span class="st">"True Labeling"</span>,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">                         <span class="dt">subtitle =</span> <span class="st">"t-SNE Embedding"</span>,</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">                         <span class="dt">featurename =</span> <span class="st">"Annotated Cell Types"</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-11-1.png" width="100%" height="100%"></p>
</div>
</div>
<div id="find-cluster-marker-genes-" class="section level2">
<h2 class="hasAnchor">
<a href="#find-cluster-marker-genes-" class="anchor"></a>Find cluster marker genes.</h2>
<p>Previously, we clustered the cells using L2R2/Sym-NMF, now we analyze the markers of the clusters. We look at the normalized expression values of all genes using pre-selection parameters similar to the pre-clustering selection parameters. The top six markers selected as described in Wang et. al. As expected, markers Krt14, Krt10, and Lor are inferred for clusters overlapping with IHC-based Basal, Differentiated (IFE-DI, IFE-DII), and Keratinized (IFE-KI, IFE-KII) cell annotations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">markers &lt;-<span class="st"> </span><span class="kw"><a href="../reference/GetMarkerTable.html">GetMarkerTable</a></span>(<span class="dt">counts_data =</span> filtered_data,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                          <span class="dt">cluster_labels =</span> labels,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">                          <span class="dt">H =</span> H,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                          <span class="dt">n_sorted =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">                          <span class="dt">gene_names =</span> gene_names,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">                          <span class="dt">gene_expression_threshold =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">                          <span class="dt">n_features =</span> <span class="dv">20000</span>,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">                          <span class="dt">use_H =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="kw"><a href="../reference/PlotTopN.html">PlotTopN</a></span>(<span class="dt">data =</span> <span class="kw">log</span>(data<span class="op">+</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">         <span class="dt">gene_names =</span> gene_names,</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">         <span class="dt">cluster_labels =</span> labels,</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">         <span class="dt">markers =</span> markers<span class="op">$</span>all,</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">         <span class="dt">n_features =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div id="pseudotime-inference" class="section level2">
<h2 class="hasAnchor">
<a href="#pseudotime-inference" class="anchor"></a>Pseudotime Inference</h2>
<p>Compute cluster-cluster graph and find the root cluster.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">cluster_ptime &lt;-<span class="st"> </span><span class="kw"><a href="../reference/FindRootCluster.html">FindRootCluster</a></span>(<span class="dt">cluster_labels =</span> labels,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                                 <span class="dt">flat_embedding =</span> low_dim_mapping<span class="op">$</span>flat_embedding,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">                                 <span class="dt">dist_graph =</span> low_dim_mapping<span class="op">$</span>dist_graph,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">                                 <span class="dt">dist_flat =</span> low_dim_mapping<span class="op">$</span>dist_flat,</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">                                 <span class="dt">reverse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Compute the cell-cell graph and find the root cell.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">root_cell &lt;-<span class="st"> </span><span class="kw"><a href="../reference/FindRootCell.html">FindRootCell</a></span>(<span class="dt">use_flat_dist =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                          <span class="dt">cluster_order_by =</span> <span class="st">"distance"</span>,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                          <span class="dt">cell_order_by =</span> <span class="st">"distance"</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                          <span class="dt">graph_cluster_mst =</span> cluster_ptime<span class="op">$</span>cluster_mst,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                          <span class="dt">dist_graph  =</span> low_dim_mapping<span class="op">$</span>dist_graph,</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">                          <span class="dt">dist_flat =</span> low_dim_mapping<span class="op">$</span>dist_flat,</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">                          <span class="dt">cluster_labels =</span> labels,</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">                          <span class="dt">root_cluster =</span> cluster_ptime<span class="op">$</span>root_cluster)</a></code></pre></div>
</div>
<div id="pseudotime-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#pseudotime-visualization" class="anchor"></a>Pseudotime Visualization</h2>
<p>Compute the directional minimum spanning tree on the cluster-cluster graph for visualization.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">cluster_predecessors &lt;-<span class="st"> </span><span class="kw"><a href="../reference/GetPredecessors.html">GetPredecessors</a></span>(cluster_ptime<span class="op">$</span>cluster_mst, cluster_ptime<span class="op">$</span>root_cluster)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">cluster_dtree &lt;-<span class="st"> </span><span class="kw"><a href="../reference/GetDominatorTree.html">GetDominatorTree</a></span>(cluster_predecessors, cluster_ptime<span class="op">$</span>graph_cluster)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw"><a href="../reference/PlotLineage.html">PlotLineage</a></span>(cluster_dtree)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-15-1.png" width="100%" height="100%"></p>
<p>Compute the path-length vector from root, and plot the cells in the previously computed low-dimensional embedding.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">pseudotime &lt;-<span class="st"> </span>low_dim_mapping<span class="op">$</span>dist_graph[root_cell,]</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co"># plot pseudotime</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span>(<span class="dt">flat_embedding =</span> low_dim_mapping<span class="op">$</span>flat_embedding,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">                         <span class="dt">feature =</span> pseudotime,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">                         <span class="dt">title =</span> <span class="st">"Pseudotime Labeling"</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">                         <span class="dt">subtitle =</span> <span class="st">"t-SNE Embedding"</span>,</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">                         <span class="dt">featurename =</span> <span class="st">"Pseudotime Distance"</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-16-1.png" width="100%" height="100%"></p>
</div>
<div id="plot-gene-expression-on-the-flat-embedding" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-gene-expression-on-the-flat-embedding" class="anchor"></a>Plot Gene Expression on the Flat Embedding</h2>
<p>Plot Expression of Krt14, Krt10, and Lor in t-SNE Space:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">gene_index &lt;-<span class="st"> </span><span class="kw">which</span>(gene_names <span class="op">==</span><span class="st"> 'Krt14'</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">data_gene &lt;-<span class="st"> </span>logdata[gene_index,]</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co"># plot features</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span>(<span class="dt">flat_embedding =</span> low_dim_mapping<span class="op">$</span>flat_embedding,</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">                    <span class="dt">feature =</span> data_gene,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">                    <span class="dt">title =</span> <span class="st">"Krt14 Expression"</span>,</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">                    <span class="dt">subtitle =</span> <span class="st">"t-SNE Embedding"</span>,</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">                    <span class="dt">featurename =</span> <span class="st">"Log Expression"</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-17-1.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">gene_index &lt;-<span class="st"> </span><span class="kw">which</span>(gene_names <span class="op">==</span><span class="st"> 'Krt10'</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">data_gene &lt;-<span class="st"> </span>logdata[gene_index,]</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co"># plot features</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span>(<span class="dt">flat_embedding =</span> low_dim_mapping<span class="op">$</span>flat_embedding,</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                    <span class="dt">feature =</span> data_gene,</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">                    <span class="dt">title =</span> <span class="st">"Krt10 Expression"</span>,</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">                    <span class="dt">subtitle =</span> <span class="st">"t-SNE Embedding"</span>,</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">                    <span class="dt">featurename =</span> <span class="st">"Log Expression"</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-18-1.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">gene_index &lt;-<span class="st"> </span><span class="kw">which</span>(gene_names <span class="op">==</span><span class="st"> 'Lor'</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">data_gene &lt;-<span class="st"> </span>logdata[gene_index,]</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co"># plot features</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span>(<span class="dt">flat_embedding =</span> low_dim_mapping<span class="op">$</span>flat_embedding,</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">                    <span class="dt">feature =</span> data_gene,</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">                    <span class="dt">title =</span> <span class="st">"Lor Expression"</span>,</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">                    <span class="dt">subtitle =</span> <span class="st">"t-SNE Embedding"</span>,</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">                    <span class="dt">featurename =</span> <span class="st">"Log Expression"</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-19-1.png" width="100%" height="100%"></p>
</div>
<div id="plot-gene-expression-levels-in-cells-grouped-by-cluster" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-gene-expression-levels-in-cells-grouped-by-cluster" class="anchor"></a>Plot Gene Expression Levels in Cells Grouped by Cluster</h2>
<p>Violin Plot of Krt14 expression. Note strong expression of the basal compartment:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">  <span class="kw">plot</span>(<span class="kw"><a href="../reference/ViolinPlotExpression.html">ViolinPlotExpression</a></span>(<span class="dt">data =</span> logdata,</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">                       <span class="dt">gene_names =</span> gene_names,</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">                       <span class="dt">labels =</span> labels,</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">                       <span class="dt">gene_name =</span> <span class="st">"Krt14"</span>))</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-20-1.png" width="100%" height="100%"> Violin Plot of Krt10 expression. Note uniformly high expression in the IFE-DI/DII compartments:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">  <span class="kw">plot</span>(<span class="kw"><a href="../reference/ViolinPlotExpression.html">ViolinPlotExpression</a></span>(<span class="dt">data =</span> logdata,</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">                       <span class="dt">gene_names =</span> gene_names,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">                       <span class="dt">labels =</span> labels,</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">                       <span class="dt">gene_name =</span> <span class="st">"Krt10"</span>))</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-21-1.png" width="100%" height="100%"> Violin Plot of Lor expression. Note strong expression in the terminally differentiated IFE-KI/KII compartments:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">  <span class="kw">plot</span>(<span class="kw"><a href="../reference/ViolinPlotExpression.html">ViolinPlotExpression</a></span>(<span class="dt">data =</span> logdata,</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">                       <span class="dt">gene_names =</span> gene_names,</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">                       <span class="dt">labels =</span> labels,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">                       <span class="dt">gene_name =</span> <span class="st">"Lor"</span>))</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-22-1.png" width="100%" height="100%"></p>
</div>
<div id="analyze-signaling-mediated-by-a-ligand-receptor-family" class="section level2">
<h2 class="hasAnchor">
<a href="#analyze-signaling-mediated-by-a-ligand-receptor-family" class="anchor"></a>Analyze Signaling Mediated by a Ligand-Receptor Family</h2>
<p>In order to analyze signaling, we can load in tables which describe a pathay in detail. There are two tables needed, one that specifies all unique ligand receptor combinations and another that specifies receptor/target/up|down combinations. Example tables for the TgfB pathway are provided in extdata/ and loaded here for the current skin data set. Using the ImportPathway function, an inner join over the two tables tabulates all ligand/receptor/target/direction 4-tuples. We then compute the probability of intercellular interaction based on this pathway.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">lig_rec_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"tgfb_lig_rec.tsv"</span>, <span class="dt">package =</span> <span class="st">"RSoptSC"</span>)</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">rec_target_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"tgfb_rec_target_both.tsv"</span>, <span class="dt">package =</span> <span class="st">"RSoptSC"</span>)</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">pathway &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ImportPathway.html">ImportPathway</a></span>(<span class="dt">lig_table_path =</span> lig_rec_path,</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">                         <span class="dt">rec_table_path =</span> rec_target_path,</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">                         <span class="dt">data =</span> logdata,</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">                         <span class="dt">gene_names =</span> gene_names)</a>
<a class="sourceLine" id="cb22-10" data-line-number="10"></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"></a>
<a class="sourceLine" id="cb22-13" data-line-number="13">pathway<span class="op">$</span>pathway <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/kableExtra/topics/kable_styling">kable_styling</a></span>()</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
receptor
</th>
<th style="text-align:left;">
ligand
</th>
<th style="text-align:left;">
target
</th>
<th style="text-align:left;">
direction
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">  </a>
<a class="sourceLine" id="cb23-2" data-line-number="2">  Pmats &lt;-<span class="st"> </span><span class="kw"><a href="../reference/GetSignalingPartners.html">GetSignalingPartners</a></span>(logdata,</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">                                gene_names,</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">                                pathway<span class="op">$</span>pathway_removed)</a></code></pre></div>
<div id="circos-plot-of-intercellular-network" class="section level3">
<h3 class="hasAnchor">
<a href="#circos-plot-of-intercellular-network" class="anchor"></a>Circos Plot of Intercellular Network</h3>
<p>Now plot the previous result as a circos plot on the top five ligand-producing and top five receptor-bearing cells from every cluster. The upper hemisphere of the plot shows receptor-bearing cells. The chords of the plot are colored by the ligand-producing cells in the lower hemisphere.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/SigPlot.html">SigPlot</a></span>(<span class="dt">P =</span> Pmats<span class="op">$</span>P_agg,</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">        <span class="dt">cluster_labels =</span> labels,</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">        <span class="dt">lig_cells_per_cluster =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">        <span class="dt">rec_cells_per_cluster =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">        <span class="dt">rgb_gap =</span> <span class="fl">0.06</span>,</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">        <span class="dt">title_text =</span> <span class="st">"Signaling Between Cells"</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-25-1.png" width="100%" height="100%"></p>
</div>
<div id="circos-plot-of-intercluster-network" class="section level3">
<h3 class="hasAnchor">
<a href="#circos-plot-of-intercluster-network" class="anchor"></a>Circos Plot of Intercluster Network</h3>
<p>Directional plot of cluster-to-cluster signaling. The root of the directional chord is raised.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">  cluster_P &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ClusterSig.html">ClusterSig</a></span>(Pmats<span class="op">$</span>P_agg,</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">                          <span class="dt">cluster_labels =</span> labels)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">#&gt; Called from: ClusterSig(Pmats$P_agg, cluster_labels = labels)</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#277: for (col in 1:ncol(sums)) {</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#&gt;     for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt;         if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">#&gt;             sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">#&gt;                 1]</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="co">#&gt;         }</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="co">#&gt;         else {</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="co">#&gt;             sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="co">#&gt;         }</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#278: for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co">#&gt;     if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="co">#&gt;         sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18"><span class="co">#&gt;             1]</span></a>
<a class="sourceLine" id="cb25-19" data-line-number="19"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-20" data-line-number="20"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="co">#&gt;         sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-26" data-line-number="26"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-27" data-line-number="27"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-28" data-line-number="28"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-29" data-line-number="29"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-30" data-line-number="30"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-31" data-line-number="31"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-32" data-line-number="32"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-33" data-line-number="33"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-34" data-line-number="34"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-35" data-line-number="35"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-36" data-line-number="36"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-37" data-line-number="37"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-38" data-line-number="38"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-39" data-line-number="39"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-40" data-line-number="40"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-41" data-line-number="41"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-42" data-line-number="42"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-43" data-line-number="43"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-44" data-line-number="44"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-45" data-line-number="45"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-46" data-line-number="46"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-47" data-line-number="47"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-48" data-line-number="48"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-49" data-line-number="49"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-50" data-line-number="50"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-51" data-line-number="51"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-52" data-line-number="52"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-53" data-line-number="53"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-54" data-line-number="54"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-55" data-line-number="55"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-56" data-line-number="56"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-57" data-line-number="57"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-58" data-line-number="58"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-59" data-line-number="59"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-60" data-line-number="60"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-61" data-line-number="61"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-62" data-line-number="62"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-63" data-line-number="63"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-64" data-line-number="64"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-65" data-line-number="65"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-66" data-line-number="66"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-67" data-line-number="67"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-68" data-line-number="68"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-69" data-line-number="69"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-70" data-line-number="70"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-71" data-line-number="71"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-72" data-line-number="72"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-73" data-line-number="73"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-74" data-line-number="74"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-75" data-line-number="75"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-76" data-line-number="76"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-77" data-line-number="77"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-78" data-line-number="78"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-79" data-line-number="79"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-80" data-line-number="80"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#278: for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-81" data-line-number="81"><span class="co">#&gt;     if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-82" data-line-number="82"><span class="co">#&gt;         sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-83" data-line-number="83"><span class="co">#&gt;             1]</span></a>
<a class="sourceLine" id="cb25-84" data-line-number="84"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-85" data-line-number="85"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb25-86" data-line-number="86"><span class="co">#&gt;         sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-87" data-line-number="87"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-88" data-line-number="88"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-89" data-line-number="89"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-90" data-line-number="90"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-91" data-line-number="91"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-92" data-line-number="92"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-93" data-line-number="93"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-94" data-line-number="94"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-95" data-line-number="95"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-96" data-line-number="96"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-97" data-line-number="97"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-98" data-line-number="98"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-99" data-line-number="99"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-100" data-line-number="100"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-101" data-line-number="101"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-102" data-line-number="102"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-103" data-line-number="103"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-104" data-line-number="104"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-105" data-line-number="105"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-106" data-line-number="106"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-107" data-line-number="107"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-108" data-line-number="108"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-109" data-line-number="109"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-110" data-line-number="110"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-111" data-line-number="111"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-112" data-line-number="112"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-113" data-line-number="113"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-114" data-line-number="114"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-115" data-line-number="115"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-116" data-line-number="116"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-117" data-line-number="117"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-118" data-line-number="118"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-119" data-line-number="119"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-120" data-line-number="120"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-121" data-line-number="121"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-122" data-line-number="122"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-123" data-line-number="123"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-124" data-line-number="124"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-125" data-line-number="125"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-126" data-line-number="126"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-127" data-line-number="127"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-128" data-line-number="128"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-129" data-line-number="129"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-130" data-line-number="130"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-131" data-line-number="131"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-132" data-line-number="132"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-133" data-line-number="133"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-134" data-line-number="134"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-135" data-line-number="135"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-136" data-line-number="136"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-137" data-line-number="137"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-138" data-line-number="138"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-139" data-line-number="139"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-140" data-line-number="140"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-141" data-line-number="141"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-142" data-line-number="142"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-143" data-line-number="143"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-144" data-line-number="144"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-145" data-line-number="145"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#278: for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-146" data-line-number="146"><span class="co">#&gt;     if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-147" data-line-number="147"><span class="co">#&gt;         sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-148" data-line-number="148"><span class="co">#&gt;             1]</span></a>
<a class="sourceLine" id="cb25-149" data-line-number="149"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-150" data-line-number="150"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb25-151" data-line-number="151"><span class="co">#&gt;         sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-152" data-line-number="152"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-153" data-line-number="153"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-154" data-line-number="154"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-155" data-line-number="155"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-156" data-line-number="156"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-157" data-line-number="157"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-158" data-line-number="158"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-159" data-line-number="159"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-160" data-line-number="160"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-161" data-line-number="161"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-162" data-line-number="162"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-163" data-line-number="163"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-164" data-line-number="164"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-165" data-line-number="165"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-166" data-line-number="166"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-167" data-line-number="167"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-168" data-line-number="168"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-169" data-line-number="169"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-170" data-line-number="170"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-171" data-line-number="171"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-172" data-line-number="172"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-173" data-line-number="173"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-174" data-line-number="174"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-175" data-line-number="175"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-176" data-line-number="176"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-177" data-line-number="177"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-178" data-line-number="178"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-179" data-line-number="179"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-180" data-line-number="180"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-181" data-line-number="181"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-182" data-line-number="182"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-183" data-line-number="183"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-184" data-line-number="184"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-185" data-line-number="185"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-186" data-line-number="186"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-187" data-line-number="187"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-188" data-line-number="188"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-189" data-line-number="189"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-190" data-line-number="190"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-191" data-line-number="191"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-192" data-line-number="192"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-193" data-line-number="193"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-194" data-line-number="194"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-195" data-line-number="195"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-196" data-line-number="196"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-197" data-line-number="197"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-198" data-line-number="198"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-199" data-line-number="199"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-200" data-line-number="200"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-201" data-line-number="201"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-202" data-line-number="202"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-203" data-line-number="203"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-204" data-line-number="204"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-205" data-line-number="205"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-206" data-line-number="206"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-207" data-line-number="207"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-208" data-line-number="208"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-209" data-line-number="209"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-210" data-line-number="210"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#278: for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-211" data-line-number="211"><span class="co">#&gt;     if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-212" data-line-number="212"><span class="co">#&gt;         sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-213" data-line-number="213"><span class="co">#&gt;             1]</span></a>
<a class="sourceLine" id="cb25-214" data-line-number="214"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-215" data-line-number="215"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb25-216" data-line-number="216"><span class="co">#&gt;         sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-217" data-line-number="217"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-218" data-line-number="218"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-219" data-line-number="219"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-220" data-line-number="220"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-221" data-line-number="221"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-222" data-line-number="222"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-223" data-line-number="223"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-224" data-line-number="224"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-225" data-line-number="225"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-226" data-line-number="226"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-227" data-line-number="227"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-228" data-line-number="228"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-229" data-line-number="229"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-230" data-line-number="230"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-231" data-line-number="231"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-232" data-line-number="232"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-233" data-line-number="233"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-234" data-line-number="234"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-235" data-line-number="235"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-236" data-line-number="236"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-237" data-line-number="237"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-238" data-line-number="238"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-239" data-line-number="239"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-240" data-line-number="240"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-241" data-line-number="241"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-242" data-line-number="242"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-243" data-line-number="243"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-244" data-line-number="244"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-245" data-line-number="245"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-246" data-line-number="246"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-247" data-line-number="247"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-248" data-line-number="248"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-249" data-line-number="249"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-250" data-line-number="250"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-251" data-line-number="251"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-252" data-line-number="252"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-253" data-line-number="253"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-254" data-line-number="254"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-255" data-line-number="255"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-256" data-line-number="256"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-257" data-line-number="257"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-258" data-line-number="258"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-259" data-line-number="259"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-260" data-line-number="260"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-261" data-line-number="261"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-262" data-line-number="262"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-263" data-line-number="263"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-264" data-line-number="264"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-265" data-line-number="265"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-266" data-line-number="266"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-267" data-line-number="267"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-268" data-line-number="268"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-269" data-line-number="269"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-270" data-line-number="270"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-271" data-line-number="271"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-272" data-line-number="272"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-273" data-line-number="273"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-274" data-line-number="274"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-275" data-line-number="275"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#278: for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-276" data-line-number="276"><span class="co">#&gt;     if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-277" data-line-number="277"><span class="co">#&gt;         sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-278" data-line-number="278"><span class="co">#&gt;             1]</span></a>
<a class="sourceLine" id="cb25-279" data-line-number="279"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-280" data-line-number="280"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb25-281" data-line-number="281"><span class="co">#&gt;         sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-282" data-line-number="282"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-283" data-line-number="283"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-284" data-line-number="284"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-285" data-line-number="285"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-286" data-line-number="286"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-287" data-line-number="287"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-288" data-line-number="288"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-289" data-line-number="289"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-290" data-line-number="290"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-291" data-line-number="291"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-292" data-line-number="292"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-293" data-line-number="293"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-294" data-line-number="294"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-295" data-line-number="295"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-296" data-line-number="296"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-297" data-line-number="297"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-298" data-line-number="298"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-299" data-line-number="299"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-300" data-line-number="300"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-301" data-line-number="301"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-302" data-line-number="302"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-303" data-line-number="303"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-304" data-line-number="304"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-305" data-line-number="305"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-306" data-line-number="306"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-307" data-line-number="307"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-308" data-line-number="308"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-309" data-line-number="309"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-310" data-line-number="310"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-311" data-line-number="311"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-312" data-line-number="312"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-313" data-line-number="313"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-314" data-line-number="314"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-315" data-line-number="315"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-316" data-line-number="316"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-317" data-line-number="317"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-318" data-line-number="318"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-319" data-line-number="319"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-320" data-line-number="320"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-321" data-line-number="321"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-322" data-line-number="322"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-323" data-line-number="323"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-324" data-line-number="324"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-325" data-line-number="325"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-326" data-line-number="326"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-327" data-line-number="327"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-328" data-line-number="328"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-329" data-line-number="329"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-330" data-line-number="330"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-331" data-line-number="331"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-332" data-line-number="332"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-333" data-line-number="333"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-334" data-line-number="334"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-335" data-line-number="335"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-336" data-line-number="336"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-337" data-line-number="337"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-338" data-line-number="338"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-339" data-line-number="339"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-340" data-line-number="340"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#278: for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-341" data-line-number="341"><span class="co">#&gt;     if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-342" data-line-number="342"><span class="co">#&gt;         sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-343" data-line-number="343"><span class="co">#&gt;             1]</span></a>
<a class="sourceLine" id="cb25-344" data-line-number="344"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-345" data-line-number="345"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb25-346" data-line-number="346"><span class="co">#&gt;         sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-347" data-line-number="347"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-348" data-line-number="348"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-349" data-line-number="349"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-350" data-line-number="350"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-351" data-line-number="351"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-352" data-line-number="352"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-353" data-line-number="353"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-354" data-line-number="354"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-355" data-line-number="355"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-356" data-line-number="356"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-357" data-line-number="357"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-358" data-line-number="358"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-359" data-line-number="359"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-360" data-line-number="360"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-361" data-line-number="361"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-362" data-line-number="362"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-363" data-line-number="363"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-364" data-line-number="364"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-365" data-line-number="365"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-366" data-line-number="366"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-367" data-line-number="367"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-368" data-line-number="368"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-369" data-line-number="369"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-370" data-line-number="370"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-371" data-line-number="371"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-372" data-line-number="372"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-373" data-line-number="373"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-374" data-line-number="374"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-375" data-line-number="375"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-376" data-line-number="376"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-377" data-line-number="377"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-378" data-line-number="378"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-379" data-line-number="379"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-380" data-line-number="380"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-381" data-line-number="381"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-382" data-line-number="382"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-383" data-line-number="383"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-384" data-line-number="384"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-385" data-line-number="385"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-386" data-line-number="386"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-387" data-line-number="387"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-388" data-line-number="388"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-389" data-line-number="389"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-390" data-line-number="390"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-391" data-line-number="391"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-392" data-line-number="392"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-393" data-line-number="393"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-394" data-line-number="394"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-395" data-line-number="395"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-396" data-line-number="396"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-397" data-line-number="397"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-398" data-line-number="398"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-399" data-line-number="399"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-400" data-line-number="400"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-401" data-line-number="401"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-402" data-line-number="402"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-403" data-line-number="403"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-404" data-line-number="404"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-405" data-line-number="405"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#278: for (row in 1:nrow(sums)) {</span></a>
<a class="sourceLine" id="cb25-406" data-line-number="406"><span class="co">#&gt;     if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-407" data-line-number="407"><span class="co">#&gt;         sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-408" data-line-number="408"><span class="co">#&gt;             1]</span></a>
<a class="sourceLine" id="cb25-409" data-line-number="409"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-410" data-line-number="410"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb25-411" data-line-number="411"><span class="co">#&gt;         sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-412" data-line-number="412"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb25-413" data-line-number="413"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-414" data-line-number="414"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-415" data-line-number="415"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-416" data-line-number="416"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-417" data-line-number="417"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-418" data-line-number="418"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-419" data-line-number="419"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-420" data-line-number="420"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-421" data-line-number="421"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-422" data-line-number="422"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-423" data-line-number="423"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-424" data-line-number="424"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-425" data-line-number="425"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-426" data-line-number="426"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-427" data-line-number="427"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-428" data-line-number="428"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-429" data-line-number="429"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-430" data-line-number="430"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-431" data-line-number="431"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-432" data-line-number="432"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-433" data-line-number="433"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-434" data-line-number="434"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-435" data-line-number="435"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-436" data-line-number="436"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-437" data-line-number="437"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-438" data-line-number="438"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-439" data-line-number="439"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-440" data-line-number="440"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-441" data-line-number="441"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-442" data-line-number="442"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-443" data-line-number="443"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-444" data-line-number="444"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-445" data-line-number="445"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-446" data-line-number="446"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-447" data-line-number="447"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-448" data-line-number="448"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-449" data-line-number="449"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-450" data-line-number="450"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-451" data-line-number="451"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-452" data-line-number="452"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-453" data-line-number="453"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-454" data-line-number="454"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-455" data-line-number="455"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-456" data-line-number="456"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-457" data-line-number="457"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-458" data-line-number="458"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-459" data-line-number="459"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-460" data-line-number="460"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-461" data-line-number="461"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-462" data-line-number="462"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#279: if (nzcounts[row, 1] &gt; 0 &amp; nzcounts[col, 1] &gt; 0) {</span></a>
<a class="sourceLine" id="cb25-463" data-line-number="463"><span class="co">#&gt;     sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-464" data-line-number="464"><span class="co">#&gt;         1]</span></a>
<a class="sourceLine" id="cb25-465" data-line-number="465"><span class="co">#&gt; } else {</span></a>
<a class="sourceLine" id="cb25-466" data-line-number="466"><span class="co">#&gt;     sums[row, col] &lt;- 0</span></a>
<a class="sourceLine" id="cb25-467" data-line-number="467"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb25-468" data-line-number="468"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#280: sums[row, col] &lt;- sums[row, col]/nzcounts[row, 1]/nzcounts[col, </span></a>
<a class="sourceLine" id="cb25-469" data-line-number="469"><span class="co">#&gt;     1]</span></a>
<a class="sourceLine" id="cb25-470" data-line-number="470"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#287: arclabs &lt;- paste0("C", c(1:n_clusters))</span></a>
<a class="sourceLine" id="cb25-471" data-line-number="471"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#288: rownames(sums) &lt;- rownames(counts)</span></a>
<a class="sourceLine" id="cb25-472" data-line-number="472"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#289: colnames(sums) &lt;- rownames(counts)</span></a>
<a class="sourceLine" id="cb25-473" data-line-number="473"><span class="co">#&gt; debug at /home/au/mkarikom/Software/RSoptSC/R/Signaling.R#290: return(sums)</span></a>
<a class="sourceLine" id="cb25-474" data-line-number="474">  <span class="kw"><a href="../reference/SigPlot.html">SigPlot</a></span>(<span class="dt">P =</span> cluster_P,</a>
<a class="sourceLine" id="cb25-475" data-line-number="475">          <span class="dt">cluster_labels =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n_clusters),</a>
<a class="sourceLine" id="cb25-476" data-line-number="476">          <span class="dt">rgb_gap =</span> <span class="fl">0.60</span>,</a>
<a class="sourceLine" id="cb25-477" data-line-number="477">          <span class="dt">title_text =</span> <span class="st">"Signaling Between Clusters"</span>)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-26-1.png" width="100%" height="100%"></p>
</div>
<div id="heatmap-of-signaling-marker-expression" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmap-of-signaling-marker-expression" class="anchor"></a>Heatmap of Signaling Marker Expression</h3>
<p>Visualize the expression of ligand/receptor and up/down target expression across clusters</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">  gene_list =<span class="st"> </span><span class="kw">c</span>(<span class="st">'Tgfb1'</span>, <span class="st">'Tgfb2'</span>, </a>
<a class="sourceLine" id="cb26-2" data-line-number="2">                <span class="st">'Tgfbr1'</span>, <span class="st">'Tgfbr2'</span>,</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">                <span class="st">'Zeb2'</span>,<span class="st">'Smad2'</span>,<span class="st">'Wnt4'</span>,<span class="st">'Wnt11'</span>,<span class="st">'Bmp7'</span>,<span class="st">'Sox9'</span>,<span class="st">'Notch1'</span>)</a>
<a class="sourceLine" id="cb26-4" data-line-number="4"></a>
<a class="sourceLine" id="cb26-5" data-line-number="5">  <span class="kw"><a href="../reference/PlotClusterExpression.html">PlotClusterExpression</a></span>(<span class="dt">data =</span> logdata,</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">                        <span class="dt">gene_names =</span> gene_names,</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">                        <span class="dt">cluster_labels =</span> labels, </a>
<a class="sourceLine" id="cb26-8" data-line-number="8">                        <span class="dt">markers =</span> gene_list)</a></code></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-27-1.png" width="100%" height="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-and-preprocess-data">Load and Preprocess Data</a></li>
      <li><a href="#compute-the-similarity-matrix">Compute the Similarity Matrix</a></li>
      <li><a href="#cluster-the-cells">Cluster the Cells</a></li>
      <li><a href="#find-cluster-marker-genes-">Find cluster marker genes.</a></li>
      <li><a href="#pseudotime-inference">Pseudotime Inference</a></li>
      <li><a href="#pseudotime-visualization">Pseudotime Visualization</a></li>
      <li><a href="#plot-gene-expression-on-the-flat-embedding">Plot Gene Expression on the Flat Embedding</a></li>
      <li><a href="#plot-gene-expression-levels-in-cells-grouped-by-cluster">Plot Gene Expression Levels in Cells Grouped by Cluster</a></li>
      <li><a href="#analyze-signaling-mediated-by-a-ligand-receptor-family">Analyze Signaling Mediated by a Ligand-Receptor Family</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Matt Karikomi, Shuxiong Wang, Adam MacLean.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
